# HACPP模式使用指南

## 什么是HACPP模式？

HACPP (High-Accuracy Cheap-Preprocessing Protocol) 是一个创新的双AI协作模式，旨在通过便宜AI进行需求分析和项目理解，然后由更昂贵的AI执行具体的代码实现，从而实现成本效益的最优化。

## 核心理念

- **便宜AI (Cheap AI)**: 负责分析用户需求、理解项目结构、确定需要修改的文件
- **贵AI (Expensive AI)**: 负责执行具体的代码编写、文件修改、工具调用等操作
- **协作流程**: 便宜AI先做分析规划，贵AI根据分析结果执行具体任务

## 使用流程

### 1. 激活HACPP模式

```bash
/HACPP
```

系统会要求输入测试码，默认测试码为：`2255`

### 2. 设置便宜模型

```bash
/HACPP model
```

输入便宜模型的名称，例如：`gpt-3.5-turbo`

### 3. 开始使用

激活并配置完成后，直接输入您的需求即可。系统会自动：

1. 使用便宜AI分析需求和项目结构
2. 确定需要修改的文件
3. 将分析结果传递给贵AI
4. 贵AI执行具体的代码修改任务

### 4. 其他命令

- `/HACPP status` - 查看HACPP模式状态
- `/HACPP off` - 关闭HACPP模式

## 工作原理

### 便宜AI的职责

1. **需求分析**: 理解用户的具体需求
2. **项目理解**: 分析当前项目结构和文件组织
3. **文件识别**: 确定需要修改哪些文件以及修改原因
4. **方案规划**: 提供实现方案的概述和步骤

### 贵AI的职责

1. **代码实现**: 根据便宜AI的分析执行具体的代码编写
2. **文件操作**: 调用工具进行文件读取、修改、创建等操作
3. **任务执行**: 完成用户需求的具体实现

### 协作格式

便宜AI会按照以下格式提供分析结果：

```
FILES_TO_MODIFY:
- 文件路径1: 修改原因
- 文件路径2: 修改原因

ANALYSIS:
详细分析用户需求，说明实现方案和步骤。

PRIORITY:
HIGH/MEDIUM/LOW - 任务优先级

IMPLEMENTATION_STEPS:
1. 步骤1
2. 步骤2
3. 步骤3
```

## 优势

1. **成本优化**: 使用便宜AI处理分析工作，贵AI专注于代码实现
2. **效率提升**: 便宜AI的预分析让贵AI能更精准地执行任务
3. **质量保证**: 双重检查机制，便宜AI规划，贵AI执行
4. **资源合理分配**: 根据任务复杂度合理分配AI资源

## 使用场景

- **大型项目开发**: 需要理解复杂项目结构的开发任务
- **功能添加**: 为现有项目添加新功能
- **代码重构**: 需要分析现有代码结构的重构任务
- **Bug修复**: 需要定位问题文件的错误修复

## 注意事项

1. 确保已正确配置API密钥
2. 便宜模型和贵模型都需要支持相同的API格式
3. 测试码默认为2255，可根据需要修改
4. HACPP模式仅在激活状态下生效

## 示例使用

```bash
# 1. 激活HACPP模式
/HACPP
请输入测试码: 2255
✓ HACPP模式已激活

# 2. 设置便宜模型
/HACPP model
请输入便宜模型名称: gpt-3.5-turbo
✓ 便宜模型已设置: gpt-3.5-turbo

# 3. 开始使用
给这个游戏添加一个食物系统

# 系统会自动：
# - 便宜AI分析需求和项目结构
# - 确定需要修改的文件
# - 贵AI执行具体的代码实现
```

## 技术实现

HACPP模式基于以下技术组件：

- `HACPPMode`: 模式状态管理
- `HACPPAIClient`: 双AI协作客户端
- 项目结构分析器
- 文件解析器
- 命令处理器

## 扩展性

HACPP模式设计为可扩展的架构，支持：

- 自定义便宜AI提示词
- 自定义贵AI提示词
- 可配置的分析格式
- 灵活的模型选择

---

*HACPP模式让AI协作更智能，让开发更高效！*
